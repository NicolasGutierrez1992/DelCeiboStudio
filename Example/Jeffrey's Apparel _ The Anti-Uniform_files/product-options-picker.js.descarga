if(!customElements.get("product-options")){class ProductOptionPicker extends HTMLElement{constructor(){super(),this.form=this.parentElement,this.select=this.form.querySelector("select"),this.productOptions=this.querySelectorAll("ul"),this.productOptionsList=this.querySelectorAll("li"),this.productDropdowns=this.querySelectorAll(".product-option-picker__dropdown"),this.product={},this.chosenOptionsObject={},this.selectOptionsListObject=[],this.prepareOptions(this.select),this.getProduct().then(res=>this.product=res);for(let dropdown of this.productDropdowns)dropdown.addEventListener("click",event=>{this.dropdown(dropdown,event)}),document.addEventListener("click",event=>{event.target!==dropdown&&!dropdown.contains(event.target)&&this.closeDropdown(dropdown)});for(let list of this.productOptions)this.chosenOptionsObject[list.dataset.optionName]=list.dataset.optionValue;this.prepareSelectionListObject();var checkVariantsStocksStatus=this.selectOptionsListObject.every(option=>option.available&&option.stock!=0||option.policy!="deny");checkVariantsStocksStatus||this.checkOptionsAvailability(),document.body.addEventListener("click",event=>{var option=event.target.closest(".product-option-picker__list-item");if(option&&!option.classList.contains("disabled")&&!option.classList.contains("chosen")){this.selectionPicker(option),this.onClick(option);var checkVariantsStocksStatus2=this.selectOptionsListObject.every(option2=>option2.available&&option2.stock!=0||option2.policy!="deny");checkVariantsStocksStatus2||this.checkOptionsAvailabilityOnClick(option)}});for(let productOption of this.productOptionsList)productOption.addEventListener("focus",()=>{productOption.addEventListener("keyup",event=>{event.key==="Enter"&&productOption.click()})})}getProduct=async()=>{var handle=this.dataset.productHandle;return await fetch(`${window.Shopify.routes.root}products/${handle}.js`).then(response=>{if(!response.ok){var error=new Error(response.status);throw error}return response.json()}).catch(error=>{throw error})};prepareOptions(select){var availableOptions=[],selectOptionsList=[];for(let list of this.productOptions)availableOptions.push(list.dataset.optionName);for(let selectOption of select){var matchFound=!1;for(let productOption of this.productOptionsList)selectOption.innerText.trim()==productOption.dataset.optionValue&&(matchFound=!0);if(matchFound)selectOptionsList.push([selectOption.text.trim()]);else{var selectOptionArray=selectOption.text.split(" / ");this.productOptions.forEach(productOptions=>{productOptions.querySelectorAll("li").forEach(productOption=>{var productOptionValue=productOption.dataset.optionValue;if(productOptionValue.includes(" / ")&&selectOption.text.includes(productOption.dataset.optionValue)){var newValue=productOption.dataset.optionValue.split(" / "),newSelectOption=selectOption.text.replace(productOption.dataset.optionValue,newValue.join(" $/ "));selectOptionArray=newSelectOption.split(" / ")}})}),selectOptionsList.push(selectOptionArray.map(string=>{var newString=string.replace(/\$\//gi,"/");return newString=newString.trim(),newString}))}}for(let optionValueArray of selectOptionsList){var availableOptionsObject={};availableOptions.map(function(optionName,i){availableOptionsObject[optionName]=optionValueArray[i]}),this.selectOptionsListObject.push(availableOptionsObject)}}onClick(option){this.productOptions=option.closest("product-options").querySelectorAll("ul"),this.chosenOptionsObject={},this.selectOptionsListObject=[],this.productOptions.forEach(list=>{for(let list_item of list.children)if(list_item.classList.contains("chosen")){var chosenOptionValue=list_item.dataset.optionValue,chosenOptionName=list.dataset.optionName;this.chosenOptionsObject[chosenOptionName]=chosenOptionValue}}),this.select=option.closest(".product").querySelector(".product-options-form select"),this.prepareOptions(this.select),this.prepareSelectionListObject(),this.selectOptionsListObject.forEach(option2=>{const newOption=Object.assign({},option2);if(delete newOption.available,delete newOption.stock,delete newOption.management,delete newOption.index,delete newOption.policy,JSON.stringify(newOption)===JSON.stringify(this.chosenOptionsObject))if(typeof option2.index<"u"){this.select.selectedIndex=option2.index,this.select.dispatchEvent(new Event("change"));var variantId=this.select[option2.index].getAttribute("value"),newUrl=new URL(window.location.href);if(newUrl.searchParams.get("variant")!==null?newUrl.searchParams.set("variant",variantId):newUrl.searchParams.append("variant",variantId),Object.keys(this.product).length)for(let variant of this.product.variants)variant.id==variantId;Shopify.designMode||history.pushState({},null,newUrl)}else this.select.selectedIndex=0,this.select.dispatchEvent(new Event("change"))})}selectionPicker(option){var currentDropdown=option.parentElement,currentDropdownListItems=currentDropdown.querySelectorAll("li"),chosenElements=currentDropdown.parentElement.parentElement.querySelectorAll(".product-option-picker-chosen > span, .product-option-picker-label > .product-option-picker-label--chosen"),chosenSwatchElement=currentDropdown.parentElement.parentElement.querySelector(".product-option-picker-chosen > .product-option-swatch"),chosenOptionSwatch=option.querySelector(".product-option-swatch");for(let item of currentDropdownListItems)item.classList.remove("chosen");option.classList.add("chosen");for(let chosen of chosenElements)chosen.innerText=option.textContent.trim();if(chosenOptionSwatch){console.log("contains children",chosenOptionSwatch.children);var optionProductSwatchStyles=getComputedStyle(chosenOptionSwatch),optionSwatchColor=optionProductSwatchStyles.getPropertyValue("--product-swatch-value");optionSwatchColor.length==0&&(optionSwatchColor=option.dataset.optionValue),chosenSwatchElement&&(chosenSwatchElement.innerHTML=chosenOptionSwatch.innerHTML,chosenSwatchElement.style.setProperty("--product-swatch-value",optionSwatchColor))}}prepareSelectionListObject(){var newSelectOptions=this.selectOptionsListObject.map(obj=>Object.assign({},obj));this.select.querySelectorAll("option").forEach((option,index)=>{newSelectOptions[index].stock=parseInt(option.dataset.inventoryQuantity),newSelectOptions[index].management=option.dataset.inventoryManagement,newSelectOptions[index].policy=option.dataset.inventoryPolicy});var customSelectOptions=[];Object.entries(this.chosenOptionsObject).forEach(chosenOption=>{var eachOptions=[];this.productOptions.forEach((productOption,index)=>{if(chosenOption[0]==productOption.dataset.optionName)for(let option of productOption.children)eachOptions.push({[productOption.dataset.optionName]:option.dataset.optionValue})}),customSelectOptions.push(eachOptions)});let newcustomSelectOptions=(data=>{const result=[],resultTrimmed=[];function helper(temp,index){if(temp.length===data.length){result.push(temp);return}for(let i=0;i<data[index].length;i++)helper([...temp,data[index][i]],index+1)}return helper([],0),result.forEach(data2=>{const obj=data2.reduce((result2,item)=>({...result2,...item}),{});resultTrimmed.push(obj)}),resultTrimmed})([...customSelectOptions]),availableKeys=Object.keys(newcustomSelectOptions[0]);const finalSelectOptions=newcustomSelectOptions.map(selectOption=>{let newSelectOption=Object.assign({},selectOption);return newSelectOptions.forEach((option,index)=>{availableKeys.every(key=>option[key]==selectOption[key])?(selectOption.available=!0,newSelectOption={...selectOption,...option,index}):selectOption.hasOwnProperty("available")||(selectOption.available=!1,newSelectOption=selectOption)}),newSelectOption});this.selectOptionsListObject=finalSelectOptions}checkOptionsAvailability(){for(let productOption of this.productOptionsList)productOption.classList.remove("disabled"),productOption.classList.remove("unavailable");var newSelectOptions=this.selectOptionsListObject.map(obj=>Object.assign({},obj)),productOptionsArray={};this.productOptions.forEach(productOption=>{productOptionsArray[productOption.dataset.optionName]=Array.from(productOption.children).map(option=>option.dataset.optionValue)}),Object.keys(productOptionsArray).length==1&&newSelectOptions.forEach(option=>{(option.stock==0&&option.management!=""&&option.policy!="continue"||!option.available)&&this.productOptions.forEach(productOption=>{for(let optionValue of productOption.children)option[productOption.dataset.optionName]==optionValue.dataset.optionValue&&optionValue.classList.add("disabled")})}),this.productOptions.forEach(productOption=>{let filterdSelectOptions=newSelectOptions.filter(option=>option[productOption.dataset.optionName]!=this.chosenOptionsObject[productOption.dataset.optionName]);for(let optionValue of productOption.children)if(optionValue.dataset.optionValue!==this.chosenOptionsObject[productOption.dataset.optionName])if(filterdSelectOptions.every(option=>option.stock==0&&option.management!=""&&option.policy!="continue"||!option.available))optionValue.classList.add("disabled");else{var chosenOptionsObject=Object.assign({},this.chosenOptionsObject);delete chosenOptionsObject[productOption.dataset.optionName],filterdSelectOptions.forEach(option=>{var chosenSelectOptions=Object.entries(chosenOptionsObject).map(chosenOption=>option[chosenOption[0]]==chosenOption[1]);chosenSelectOptions.every(option2=>option2)&&(option.stock==0&&option.management!=""&&option.policy!="continue"||!option.available)&&option[productOption.dataset.optionName]==optionValue.dataset.optionValue&&optionValue.classList.add("disabled")}),filterdSelectOptions.forEach(option=>{option.available&&(option.stock!=0||option.management==""||option.policy=="continue")&&option[productOption.dataset.optionName]==optionValue.dataset.optionValue&&optionValue.classList.contains("disabled")&&(optionValue.classList.add("unavailable"),optionValue.classList.remove("disabled"))})}})}checkOptionsAvailabilityOnClick(option){var productOptionsList=option.closest("product-options").querySelectorAll("li");for(let productOption of productOptionsList)productOption.classList.remove("disabled"),productOption.classList.remove("unavailable");var newSelectOptions=this.selectOptionsListObject.map(obj=>Object.assign({},obj)),productOptionsArray={};this.productOptions.forEach(productOption=>{productOptionsArray[productOption.dataset.optionName]=Array.from(productOption.children).map(option2=>option2.dataset.optionValue)}),this.productOptions.forEach(productOption=>{let filterdSelectOptions=newSelectOptions;for(let optionValue of productOption.children)if(filterdSelectOptions.every(option2=>option2.stock==0&&option2.management!=""&&option2.policy!="continue"||!option2.available))optionValue.classList.add("disabled");else{var chosenOptionsObject=Object.assign({},this.chosenOptionsObject);delete chosenOptionsObject[productOption.dataset.optionName],filterdSelectOptions.forEach(option2=>{var chosenSelectOptions=Object.entries(chosenOptionsObject).map(chosenOption=>option2[chosenOption[0]]==chosenOption[1]);chosenSelectOptions.every(option3=>option3)&&(option2.stock==0&&option2.management!=""&&option2.policy!="continue"||!option2.available)&&option2[productOption.dataset.optionName]==optionValue.dataset.optionValue&&optionValue.classList.add("disabled")}),filterdSelectOptions.forEach(option2=>{option2.available&&(option2.stock!=0||option2.management==""||option2.policy=="continue")&&option2[productOption.dataset.optionName]==optionValue.dataset.optionValue&&optionValue.classList.contains("disabled")&&(optionValue.classList.add("unavailable"),optionValue.classList.remove("disabled"))})}})}dropdown(dropdown,event){dropdown.classList.contains("active")?(this.closeDropdown(dropdown),dropdown.blur()):dropdown.matches(":focus-within:not(:focus)")||this.openDropdown(dropdown)}openDropdown(dropdown){dropdown.classList.add("active")}closeDropdown(dropdown){dropdown.classList.remove("active")}}customElements.define("product-options",ProductOptionPicker)}
//# sourceMappingURL=/cdn/shop/t/6/assets/product-options-picker.js.map?v=88545292765368590671747736708
